{"version":3,"sources":["../src/i18n.jsx"],"names":[],"mappings":"AAAA;;;;;;;;;kBAkBe,UAAU,OAAV,EAA0D;AAAA;;AAAA,MAAvC,WAAuC,yDAA3B,EAA2B;AAAA,MAAvB,SAAuB,yDAAb,WAAa;;AACvE,MAAM,gBAAgB,QAAQ,UAAC,IAAD,EAAS;AACrC,QAAM,OAAO,QAAQ,IAAR,CAAb;AACA,aAAS,IAAT,CAAc,IAAd,EAA6B;AAC3B,UAAM,UAAW,QAAQ,KAAK,IAAL,CAAT,GAAuB,KAAK,IAAL,CAAvB,GAAoC,IAApD;;AAD2B,yCAAN,IAAM;AAAN,YAAM;AAAA;;AAE3B,aAAO,KAAK,MAAL,CACL,UAAC,CAAD,EAAI,KAAJ,EAAW,CAAX;AAAA,eAAgB,EAAE,OAAF,CAAU,WAAW,IAAI,CAAf,CAAV,EAA6B,KAA7B,CAAhB;AAAA,OADK,EACgD,OADhD,CAAP;AAED;AACD,SAAK,IAAL,GAAY;AAAA,aACV;AACE,mBAAW,SADb;AAEE,iCAAyB,EAAE,QAAQ,gCAAV;AAF3B,QADU;AAAA,KAAZ;AAKA,WAAO,IAAP;AACD,GAbqB,CAAtB;;AAeA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,wCAcoB;AAAA,qBACoB,KAAK,KADzB;AAAA,YACR,QADQ,UACR,QADQ;AAAA,YACE,aADF,UACE,aADF;;AAEhB,eAAO,EAAE,kBAAF,EAAY,IAAI,cAAc,QAAd,CAAhB,EAAP;AACD;AAjBH;AAAA;AAAA,+BAkBW;AACP,eAAO,KAAK,KAAL,CAAW,QAAlB;AACD;AApBH;;AAAA;AAAA,IAAqB,gBAAM,SAA3B,UACS,iBADT,GAC6B;AACzB,cAAU,iBAAU,MADK;AAEzB,QAAI,iBAAU,IAAV,CAAe;AAFM,GAD7B,SAKS,SALT,GAKqB;AACjB,cAAU,iBAAU,OAAV,CAAkB,UADX;AAEjB,cAAU,iBAAU,MAAV,CAAiB,UAFV;AAGjB,mBAAe,iBAAU,IAAV,CAAe;AAHb,GALrB,SAUS,YAVT,GAUwB;AACpB,cAAU,WADU;AAEpB;AAFoB,GAVxB;AAsBD,C;;AAtDD;;;;;;;;;;;;AAEA,SAAS,OAAT,CAAiB,EAAjB,EAAqB;AACnB,MAAM,QAAQ,EAAd;AACA,SAAO,YAAY;AAAA,sCAAR,IAAQ;AAAR,UAAQ;AAAA;;AACjB,QAAM,MAAM,KAAK,IAAL,CAAU,GAAV,CAAZ;AACA,QAAI,CAAC,MAAM,GAAN,CAAL,EAAiB;AACf,YAAM,GAAN,IAAa,oBAAM,IAAN,CAAb;AACD;AACD,WAAO,MAAM,GAAN,CAAP;AACD,GAND;AAOD;;AAEM,IAAM,kCAAa,QACxB,UAAC,CAAD;AAAA,SAAM,IAAI,MAAJ,OAAe,CAAf,EAAoB,GAApB,CAAN;AAAA,CADwB,CAAnB","file":"i18n.js","sourcesContent":["\"use strict\";\n\nimport React, { PropTypes } from \"react\";\n\nfunction memoize(fn) {\n  const cache = {};\n  return (...args)=> {\n    const key = args.join(\"|\");\n    if (!cache[key]) {\n      cache[key] = fn(...args);\n    }\n    return cache[key];\n  };\n}\n\nexport const getReplace = memoize(\n  (i)=> new RegExp(`%${i}`, \"g\"));\n\nexport default function (locales, defaultLang=\"\", className=\"i18n-text\") {\n  const i18nProcessor = memoize((lang)=> {\n    const dict = locales[lang];\n    function func(text, ...args) {\n      const pattern = (dict && dict[text]) ? dict[text] : text;\n      return args.reduce(\n        (m, value, i)=> m.replace(getReplace(i + 1), value), pattern);\n    }\n    func.html = (...args)=>\n      <span\n        className={className}\n        dangerouslySetInnerHTML={{ __html: func(...args) }}\n      />;\n    return func;\n  });\n\n  return class extends React.Component {\n    static childContextTypes = {\n      language: PropTypes.string,\n      __: PropTypes.func.isRequired\n    }\n    static propTypes = {\n      children: PropTypes.element.isRequired,\n      language: PropTypes.string.isRequired,\n      i18nProcessor: PropTypes.func.isRequired\n    };\n    static defaultProps = {\n      language: defaultLang,\n      i18nProcessor\n    };\n    getChildContext() {\n      const { language, i18nProcessor } = this.props;\n      return { language, __: i18nProcessor(language) };\n    }\n    render() {\n      return this.props.children;\n    }\n  };\n}\n"]}